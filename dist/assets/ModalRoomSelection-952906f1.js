import{b as t,aQ as T,aR as D,v as W,u as F,r,i as R,z as H,c as E,w as $,h as z,aS as N,a0 as O,j as c,J as b,aT as _,aU as U,t as n,aV as G,B as S,F as C,aW as J,aX as V,M as X}from"./index-ffb5f151.js";import{L as q}from"./LinkLogin-660f18f8.js";import{M as Q}from"./MiniCircle-09da5886.js";import{M as K}from"./index-a44dad43.js";const Y=({values:e})=>t("div",{css:{display:"flex",flexWrap:"wrap",gap:"6px 8px",overflow:"hidden"},children:e.map(s=>t(T,{value:s},s._id))}),w=({type:e,name:s})=>c("div",{css:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",margin:"16px 12px 10px",flex:"1 1 0"},children:[t(Q,{type:e}),t("p",{css:{...n.font12,color:n.gray_text,margin:"5px 0 1px"},children:e==="from"?"출발지":"도착지"}),t("div",{css:{display:"flex",justifyContent:"center",alignItems:"center",height:"39px",width:"100%"},children:t("p",{css:{...n.font16_bold,color:n.purple,textAlign:"center",wordBreak:"keep-all"},children:s})})]}),y=({title:e,alignDirection:s,children:i})=>c("div",{children:[t("p",{css:{...n.font12,color:n.gray_text,marginBottom:"5px",textAlign:s},children:e}),i]}),M=({roomInfo:e})=>{var v;const{i18n:s}=D(),i=W(),a=F(),d=r.useRef(!1),l=R("loginInfo"),p=R("myRooms"),o=H("myRooms"),h=E($),u=z()&&!!(l!=null&&l.id),x=e&&e.part.length>=e.maxPartLength,f=u&&e&&(e.part.some(B=>B._id===l.oid)??!0),m=u&&p&&p.ongoing.length>=K,g=N(O(e.time)),A=r.useCallback(async()=>{d.current||(d.current=!0,await i({url:"/rooms/join",method:"post",data:{roomId:e._id},onSuccess:()=>{o(),a.push(`/myroom/${e._id}`)},onError:()=>h("방 참여에 실패하였습니다.")}),d.current=!1)},[e==null?void 0:e._id,a]),j={width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},L={fontSize:"24px",color:n.gray_text},P={padding:"16px 14px",display:"grid",rowGap:"16px"},k={display:"flex",overflow:"hidden",columnGap:"12px",justifyContent:"space-between"};return c(C,{children:[t(b,{}),c("div",{css:j,children:[t(w,{type:"from",name:_(e.from,s.language)}),t(U,{style:L}),t(w,{type:"to",name:_(e.to,s.language)})]}),t(b,{}),c("div",{css:P,children:[t(y,{title:"출발 시각 & 날짜",alignDirection:"left",children:t("p",{css:n.font14_bold,children:G(e.time)??""})}),c("div",{css:k,children:[t("div",{css:{minWidth:0},children:t(y,{title:"탑승자",alignDirection:"left",children:t(Y,{values:e.part})})}),t("div",{css:{minWidth:"fit-content"},children:t(y,{title:"참여 / 최대 인원",alignDirection:"right",children:c("div",{css:{display:"flex",justifyContent:"end"},children:[t("p",{css:{...n.font14_bold,color:n.purple},children:`${(v=e==null?void 0:e.part)==null?void 0:v.length}명`}),c("p",{css:n.font14,children:[" ",`/ ${e==null?void 0:e.maxPartLength}명`]})]})})})]})]}),u||x||g?t(S,{type:"purple",disabled:x||g||f||m,css:{padding:"10px 0 9px",borderRadius:"8px",...n.font14_bold},onClick:A,children:f?"이미 참여 중입니다":g?"출발 시각이 현재 이전인 방은 참여할 수 없습니다":x?"남은 인원이 0명인 방은 참여할 수 없습니다":m?"현재 5개의 방에 참여 중입니다":"참여 신청"}):t(q,{redirect:`/home/${e==null?void 0:e._id}`,children:t(S,{type:"purple",css:{padding:"10px 0 9px",borderRadius:"8px",...n.font14_bold},children:"로그인 후 참여 신청"})})]})},Z=({children:e,onChangeHeight:s})=>{const i=r.useRef(null);return r.useEffect(()=>{if(!i.current)return;const a=new ResizeObserver(()=>{i.current&&s&&s(i.current.offsetHeight)});return a.observe(i.current),()=>a.disconnect()},[]),t("div",{css:{height:"0px",overflow:"hidden"},children:t("div",{ref:i,children:e})})},ie=({isOpen:e,onChangeIsOpen:s,roomInfo:i})=>{const[a,d]=r.useState(i),[l,p]=r.useState(0),o=r.useMemo(()=>a&&[{key:"info",name:"방 정보",body:t(M,{roomInfo:a})},{key:"share",name:"공유하기",body:t(J,{roomInfo:a,height:l})}],[a,l]);r.useEffect(()=>{i&&d(i)},[i]);const h={...n.font18,padding:"10px 8px 12px"};return t(X,{isOpen:e,onChangeIsOpen:s,css:{padding:"10px"},children:a&&c(C,{children:[t("div",{css:h,children:a.name}),o&&t(V,{pages:o}),t(Z,{onChangeHeight:p,children:t(M,{roomInfo:a})})]})})};export{ie as M};
